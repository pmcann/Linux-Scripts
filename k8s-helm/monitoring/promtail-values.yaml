# Minimal Promtail config: ship K8s container logs to Loki
config:
  clients:
    - url: http://loki.monitoring.svc.cluster.local:3100/loki/api/v1/push
  snippets:
    pipelineStages:
      - cri: {}   # parse CRI format into JSON (timestamp, stream, log)

# Run on control-plane too (taints tolerated)
tolerations:
  - key: "node-role.kubernetes.io/control-plane"
    operator: "Exists"
    effect: "NoSchedule"
  - key: "node-role.kubernetes.io/master"   # for older clusters
    operator: "Exists"
    effect: "NoSchedule"
                
